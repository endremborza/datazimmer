- add basic profiling
- move some logic
- improve logging